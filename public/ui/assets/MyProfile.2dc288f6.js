import{h as k,u as x,J as A,o as y,l as w,k as d,q as I,F as C,E,B as z,G as B,j as m,i as O,z as D,D as S,r as V,w as M}from"./index.3a7afb82.js";function b(e){return e===void 0}function $(e){return e===null}function P(e){return typeof e=="boolean"}function _(e){return e===Object(e)}function h(e){return Array.isArray(e)}function q(e){return e instanceof Date}function N(e,n){return n?_(e)&&!b(e.uri):_(e)&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.slice=="function"}function L(e,n){return N(e,n)&&typeof e.name=="string"&&(_(e.lastModifiedDate)||typeof e.lastModified=="number")}function p(e){return b(e)?!1:e}function v(e,n,s,o){n=n||{},s=s||new FormData,n.indices=p(n.indices),n.nullsAsUndefineds=p(n.nullsAsUndefineds),n.booleansAsIntegers=p(n.booleansAsIntegers),n.allowEmptyArrays=p(n.allowEmptyArrays),n.noFilesWithArrayNotation=p(n.noFilesWithArrayNotation),n.dotsForObjectNotation=p(n.dotsForObjectNotation);const f=typeof s.getParts=="function";return b(e)||($(e)?n.nullsAsUndefineds||s.append(o,""):P(e)?n.booleansAsIntegers?s.append(o,e?1:0):s.append(o,e):h(e)?e.length?e.forEach((a,t)=>{let l=o+"["+(n.indices?t:"")+"]";n.noFilesWithArrayNotation&&L(a,f)&&(l=o),v(a,n,s,l)}):n.allowEmptyArrays&&s.append(o+"[]",""):q(e)?s.append(o,e.toISOString()):_(e)&&!N(e,f)?Object.keys(e).forEach(a=>{const t=e[a];if(h(t))for(;a.length>2&&a.lastIndexOf("[]")===a.length-2;)a=a.substring(0,a.length-2);const l=o?n.dotsForObjectNotation?o+"."+a:o+"["+a+"]":a;v(t,n,s,l)}):s.append(o,e)),s}var W={serialize:v};const G={class:"shrink-0"},R=["src"],T={class:"block"},J=d("span",{class:"sr-only"},"Seleccionar Avatar",-1),H=k({__name:"InputImage",emits:["update:model-value"],setup(e,{emit:n}){const s=x(),o=A(()=>{var a;return(a=s.profile)==null?void 0:a.avatar});function f(a){var l;a.target;const t=(l=a.target)==null?void 0:l.files;t!=null&&t.length&&n("update:model-value",t[0])}return(a,t)=>(y(),w(C,null,[d("div",G,[d("img",{class:"object-cover w-32 h-32 rounded-full",src:I(o),alt:"profile photo"},null,8,R)]),d("label",T,[J,d("input",{type:"file",accept:"image/x-png,image/gif,image/jpeg",class:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100",onInput:f},null,32)])],64))}}),K=["onSubmit"],Q={class:"space-y-2"},X=d("div",{class:"my-10"},[d("button",{type:"submit",class:"btn-primary"},"Guardar")],-1),Y=k({__name:"ProfileForm",emits:["complete"],setup(e,{emit:n}){const s=x(),{axiosError:o,success:f,error:a}=E(),t=z({email:"",avatar:void 0,password:"",name:"",nick:"",password_confirmation:""}),l=A(()=>s.profile);function U(r){let i=r.replace(" ","-").toLocaleLowerCase();t.value.nick=i}async function F(){try{if(t.value.password!==t.value.password_confirmation)a("La contrase\xF1a no coincide");else{if(t.value.nick){const u=t.value.nick.length-1;u&&t.value.nick[u]==="-"&&(t.value.nick=t.value.nick.slice(0,u))}const r=W.serialize(t.value,{nullsAsUndefineds:!0,booleansAsIntegers:!0});console.log({formData:t.value.nick});const i=await s.update(r);f("Perfil actualizado"),n("complete",i)}}catch(r){o(r)}}function g(r){r&&(r.size>1e6?a("La imagen debe ser menor de 1Mb"):t.value.avatar=r)}return B(async()=>{await s.getProfile(),l.value&&(t.value={email:l.value.email,name:l.value.name,nick:l.value.nick,password:"",password_confirmation:"",avatar:void 0})}),(r,i)=>{const u=V("InputText");return y(),w("form",{onSubmit:S(F,["prevent"])},[d("div",Q,[m(H,{"onUpdate:modelValue":g}),m(u,{"id-key":"profile-name",modelValue:t.value.name,"onUpdate:modelValue":i[0]||(i[0]=c=>t.value.name=c),label:"Nombre",required:""},null,8,["modelValue"]),m(u,{"id-key":"profile-nick","model-value":t.value.nick,"onUpdate:modelValue":U,label:"Nick",required:""},null,8,["model-value"]),m(u,{"id-key":"profile-email",modelValue:t.value.email,"onUpdate:modelValue":i[1]||(i[1]=c=>t.value.email=c),label:"Email",type:"email",required:""},null,8,["modelValue"]),m(u,{"id-key":"profile-password",modelValue:t.value.password,"onUpdate:modelValue":i[2]||(i[2]=c=>t.value.password=c),label:"Cambiar Contrase\xF1a",type:"password"},null,8,["modelValue"]),t.value.password?(y(),O(u,{key:0,"id-key":"profile-password-confirmation",modelValue:t.value.password_confirmation,"onUpdate:modelValue":i[3]||(i[3]=c=>t.value.password_confirmation=c),label:"Repita Contrase\xF1a",type:"password"},null,8,["modelValue"])):D("",!0)]),X],40,K)}}}),Z={class:"p-2"},ee=k({__name:"MyProfile",setup(e){return(n,s)=>{const o=V("Card");return y(),w("div",Z,[m(o,{class:"p-4"},{default:M(()=>[m(Y)]),_:1})])}}});export{ee as default};
